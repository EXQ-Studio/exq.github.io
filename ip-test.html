<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPæ‹¦æˆªå™¨æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 50px;
            min-height: 100vh;
            box-sizing: border-box;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        .test-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
        }
        .status.success {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4CAF50;
        }
        .status.warning {
            background: rgba(255, 193, 7, 0.3);
            border: 1px solid #FFC107;
        }
        .status.error {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
        }
        .code {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›¡ï¸ IPæ‹¦æˆªå™¨æµ‹è¯•</h1>
        
        <div class="test-info">
            <h3>å½“å‰è®¿é—®ä¿¡æ¯</h3>
            <div class="code">
                ä¸»æœºå: <span id="hostname"></span><br>
                åè®®: <span id="protocol"></span><br>
                å®Œæ•´URL: <span id="fullUrl"></span><br>
                æ—¶é—´: <span id="timestamp"></span>
            </div>
        </div>

        <div id="ipCheck" class="status">
            <h3>ğŸ” IPæ£€æŸ¥ç»“æœ</h3>
            <div id="ipCheckResult">æ­£åœ¨æ£€æŸ¥...</div>
        </div>

        <div id="accessStatus" class="status">
            <h3>ğŸš¦ è®¿é—®çŠ¶æ€</h3>
            <div id="accessResult">æ­£åœ¨éªŒè¯...</div>
        </div>

        <div class="test-info">
            <h3>ğŸ§ª æµ‹è¯•åŠŸèƒ½</h3>
            <button onclick="testLocalHost()">æµ‹è¯•localhostè®¿é—®</button>
            <button onclick="testServerIP()">æµ‹è¯•æœåŠ¡å™¨IPæ‹¦æˆª</button>
            <button onclick="testDevMode()">å¯ç”¨å¼€å‘æ¨¡å¼</button>
            <button onclick="clearDevMode()">æ¸…é™¤å¼€å‘æ¨¡å¼</button>
        </div>

        <div class="test-info">
            <h3>ğŸ“‹ é…ç½®ä¿¡æ¯</h3>
            <div class="code">
                æœåŠ¡å™¨IP: 47.84.202.74 (åº”è¢«æ‹¦æˆª)<br>
                å…è®¸åŸŸå: exqstudio.cn, www.exqstudio.cn, exq-studio.github.io<br>
                æœ¬åœ°ç¯å¢ƒ: localhost, 127.0.0.1, file://åè®®
            </div>
        </div>
    </div>

    <!-- ç®€åŒ–ç‰ˆIPæ‹¦æˆªå™¨ç”¨äºæµ‹è¯• -->
    <script>
        // å¡«å……å½“å‰è®¿é—®ä¿¡æ¯
        document.getElementById('hostname').textContent = window.location.hostname;
        document.getElementById('protocol').textContent = window.location.protocol;
        document.getElementById('fullUrl').textContent = window.location.href;
        document.getElementById('timestamp').textContent = new Date().toLocaleString();

        // IPæ£€æŸ¥é€»è¾‘
        function checkIPStatus() {
            const currentHost = window.location.hostname;
            const isIP = /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(currentHost);
            const serverIPs = ['47.84.202.74'];
            const allowedDomains = ['exqstudio.cn', 'www.exqstudio.cn', 'exq-studio.github.io'];
            const localHosts = ['localhost', '127.0.0.1', '::1', ''];
            
            const ipCheckDiv = document.getElementById('ipCheck');
            const ipCheckResult = document.getElementById('ipCheckResult');
            const accessDiv = document.getElementById('accessStatus');
            const accessResult = document.getElementById('accessResult');

            // IPç±»å‹æ£€æŸ¥
            if (serverIPs.includes(currentHost)) {
                ipCheckDiv.className = 'status error';
                ipCheckResult.innerHTML = `âŒ æ£€æµ‹åˆ°æœåŠ¡å™¨IP: ${currentHost}<br>æ­¤IPåº”è¢«æ‹¦æˆªå¹¶é‡å®šå‘åˆ°åŸŸå`;
            } else if (localHosts.includes(currentHost) || window.location.protocol === 'file:') {
                ipCheckDiv.className = 'status success';
                ipCheckResult.innerHTML = `âœ… æœ¬åœ°å¼€å‘ç¯å¢ƒ: ${currentHost || 'file://åè®®'}`;
            } else if (isIP) {
                ipCheckDiv.className = 'status warning';
                ipCheckResult.innerHTML = `âš ï¸ å…¶ä»–IPåœ°å€: ${currentHost}<br>åº”è¢«æ‹¦æˆª`;
            } else if (allowedDomains.includes(currentHost)) {
                ipCheckDiv.className = 'status success';
                ipCheckResult.innerHTML = `âœ… æˆæƒåŸŸå: ${currentHost}`;
            } else {
                ipCheckDiv.className = 'status warning';
                ipCheckResult.innerHTML = `âš ï¸ æœªçŸ¥åŸŸå: ${currentHost}`;
            }

            // è®¿é—®çŠ¶æ€æ£€æŸ¥
            if (window.location.hostname === '47.84.202.74') {
                accessDiv.className = 'status error';
                accessResult.innerHTML = `ğŸš« å¦‚æœæ‚¨çœ‹åˆ°æ­¤é¡µé¢ï¼Œè¯´æ˜IPæ‹¦æˆªå¤±è´¥ï¼<br>æœåŠ¡å™¨IPè®¿é—®åº”è¯¥è¢«è‡ªåŠ¨é‡å®šå‘åˆ° exqstudio.cn`;
            } else {
                accessDiv.className = 'status success';
                accessResult.innerHTML = `âœ… æ­£å¸¸è®¿é—® - IPæ‹¦æˆªå™¨å·¥ä½œæ­£å¸¸`;
            }
        }

        // æµ‹è¯•å‡½æ•°
        function testLocalHost() {
            alert('æµ‹è¯•localhostè®¿é—®ï¼š\nè¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:8000/ip-test.html');
        }

        function testServerIP() {
            if (confirm('æµ‹è¯•æœåŠ¡å™¨IPæ‹¦æˆªï¼š\nå°†å°è¯•è®¿é—® http://47.84.202.74 \nè¯¥è®¿é—®åº”è¯¥è¢«æ‹¦æˆªå¹¶é‡å®šå‘ã€‚æ˜¯å¦ç»§ç»­ï¼Ÿ')) {
                window.open('http://47.84.202.74', '_blank');
            }
        }

        function testDevMode() {
            localStorage.setItem('dev_mode', 'true');
            alert('å¼€å‘æ¨¡å¼å·²å¯ç”¨ï¼\né¡µé¢å°†é‡æ–°åŠ è½½ä»¥åº”ç”¨è®¾ç½®ã€‚');
            window.location.reload();
        }

        function clearDevMode() {
            localStorage.removeItem('dev_mode');
            alert('å¼€å‘æ¨¡å¼å·²æ¸…é™¤ï¼\né¡µé¢å°†é‡æ–°åŠ è½½ä»¥åº”ç”¨è®¾ç½®ã€‚');
            window.location.reload();
        }

        // æ£€æŸ¥å¼€å‘æ¨¡å¼çŠ¶æ€
        function checkDevMode() {
            const isDevMode = localStorage.getItem('dev_mode') === 'true';
            if (isDevMode) {
                const devIndicator = document.createElement('div');
                devIndicator.style.cssText = 'position: fixed; top: 10px; right: 10px; background: #4CAF50; color: white; padding: 10px; border-radius: 5px; z-index: 9999; font-size: 12px;';
                devIndicator.textContent = 'ğŸ”§ å¼€å‘æ¨¡å¼å·²å¯ç”¨';
                document.body.appendChild(devIndicator);
            }
        }

        // åˆå§‹åŒ–
        checkIPStatus();
        checkDevMode();

        // æ¯5ç§’æ›´æ–°ä¸€æ¬¡æ—¶é—´æˆ³
        setInterval(() => {
            document.getElementById('timestamp').textContent = new Date().toLocaleString();
        }, 5000);
    </script>
</body>
</html>
